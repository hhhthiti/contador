<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Gerar QR Codes em PDF</title>

    <!-- QRCode.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #111;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
        }

        input {
            padding: 10px;
            margin: 8px;
            width: 250px;
            font-size: 16px;
        }

        button {
            padding: 10px 25px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }

        #qrs {
            display: none;
        }

        canvas {
            background: #fff;
        }
    </style>
</head>
<body>

    <h2>Gerar PDF com QR Codes</h2>

    <input type="text" id="matricula" placeholder="MatrÃ­cula">
    <input type="text" id="senha" placeholder="Senha">

    <button onclick="gerarPDF()">Criar</button>

    <!-- QR Codes escondidos -->
    <div id="qrs">
        <div id="qr1"></div>
        <div id="qr2"></div>
        <div id="qr3"></div>
    </div>

<script>
async function gerarQRCodeComLogo(texto, elementoId) {
    document.getElementById(elementoId).innerHTML = "";

    let qr = new QRCode(document.getElementById(elementoId), {
        text: texto,
        width: 300,
        height: 300,
        colorDark: "#000000",
        colorLight: "#ffffff",
        correctLevel: QRCode.CorrectLevel.H
    });

    await new Promise(r => setTimeout(r, 300));

    let canvas = document.querySelector(`#${elementoId} canvas`);
    let ctx = canvas.getContext("2d");

    let logo = new Image();
    logo.src = "jsl-removebg-preview.png";

    await new Promise(resolve => logo.onload = resolve);

    let size = 70;
    let x = (canvas.width - size) / 2;
    let y = (canvas.height - size) / 2;

    ctx.drawImage(logo, x, y, size, size);

    return canvas.toDataURL("image/png");
}

async function gerarPDF() {
    let matricula = document.getElementById("matricula").value;
    let senha = document.getElementById("senha").value;

    if (!matricula || !senha) {
        alert("Preencha todos os campos!");
        return;
    }

    const qrMatricula = await gerarQRCodeComLogo(matricula, "qr1");
    const qrSenha = await gerarQRCodeComLogo(senha, "qr2");
    const qrJ8 = await gerarQRCodeComLogo("j8", "qr3");

    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({
        orientation: "landscape",
        unit: "mm",
        format: "a4"
    });

    pdf.addImage(qrMatricula, "PNG", 20, 40, 70, 70);
    pdf.addImage(qrSenha, "PNG", 110, 40, 70, 70);
    pdf.addImage(qrJ8, "PNG", 200, 40, 70, 70);

    pdf.save("qrcodes.pdf");
}
</script>

</body>
</html>